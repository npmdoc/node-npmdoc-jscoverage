<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/fishbar/jscoverage"

    >jscoverage (v0.6.0)</a>
</h1>
<h4>a javascript coverage tool, can be used in node dev, and browser side js dev</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage">module jscoverage</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.config">
            function <span class="apidocSignatureSpan">jscoverage.</span>config
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.coverageStats">
            function <span class="apidocSignatureSpan">jscoverage.</span>coverageStats
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.enableInject">
            function <span class="apidocSignatureSpan">jscoverage.</span>enableInject
            <span class="apidocSignatureSpan">(bool)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.getLCOV">
            function <span class="apidocSignatureSpan">jscoverage.</span>getLCOV
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument">
            function <span class="apidocSignatureSpan">jscoverage.</span>instrument
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.process">
            function <span class="apidocSignatureSpan">jscoverage.</span>process
            <span class="apidocSignatureSpan">(filename, content)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.processFile">
            function <span class="apidocSignatureSpan">jscoverage.</span>processFile
            <span class="apidocSignatureSpan">(source, dest, option)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan"></span>jscoverage</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>detail</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>html</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>instrument.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>list</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>patch</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>spec</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>tap</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jscoverage.</span>util</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.config">module jscoverage.config</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.config.config">
            function <span class="apidocSignatureSpan">jscoverage.</span>config
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.coverageStats">module jscoverage.coverageStats</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.coverageStats.coverageStats">
            function <span class="apidocSignatureSpan">jscoverage.</span>coverageStats
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.detail">module jscoverage.detail</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.detail.process">
            function <span class="apidocSignatureSpan">jscoverage.detail.</span>process
            <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, debug)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.enableInject">module jscoverage.enableInject</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.enableInject.enableInject">
            function <span class="apidocSignatureSpan">jscoverage.</span>enableInject
            <span class="apidocSignatureSpan">(bool)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.getLCOV">module jscoverage.getLCOV</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.getLCOV.getLCOV">
            function <span class="apidocSignatureSpan">jscoverage.</span>getLCOV
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.html">module jscoverage.html</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.html.process">
            function <span class="apidocSignatureSpan">jscoverage.html.</span>process
            <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.instrument">module jscoverage.instrument</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument.instrument">
            function <span class="apidocSignatureSpan">jscoverage.</span>instrument
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.instrument.prototype">module jscoverage.instrument.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument.prototype.checkIfIgnore">
            function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>checkIfIgnore
            <span class="apidocSignatureSpan">(node, stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument.prototype.ifExclude">
            function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>ifExclude
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument.prototype.inject">
            function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>inject
            <span class="apidocSignatureSpan">(type, line, expr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument.prototype.process">
            function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>process
            <span class="apidocSignatureSpan">(filename, code)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.instrument.prototype.protectEmptyBlock">
            function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>protectEmptyBlock
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>T_COND</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>T_LINE</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.jscoverage">module jscoverage.jscoverage</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.jscoverage.process">
            function <span class="apidocSignatureSpan">jscoverage.jscoverage.</span>process
            <span class="apidocSignatureSpan">(filename, content)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.list">module jscoverage.list</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.list.process">
            function <span class="apidocSignatureSpan">jscoverage.list.</span>process
            <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.patch">module jscoverage.patch</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.patch.enableInject">
            function <span class="apidocSignatureSpan">jscoverage.patch.</span>enableInject
            <span class="apidocSignatureSpan">(bool)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.patch.getInjectFunctions">
            function <span class="apidocSignatureSpan">jscoverage.patch.</span>getInjectFunctions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.patch.setCovIgnore">
            function <span class="apidocSignatureSpan">jscoverage.patch.</span>setCovIgnore
            <span class="apidocSignatureSpan">(ignore, bool)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.process">module jscoverage.process</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.process.process">
            function <span class="apidocSignatureSpan">jscoverage.</span>process
            <span class="apidocSignatureSpan">(filename, content)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.processFile">module jscoverage.processFile</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.processFile.processFile">
            function <span class="apidocSignatureSpan">jscoverage.</span>processFile
            <span class="apidocSignatureSpan">(source, dest, option)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.spec">module jscoverage.spec</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.spec.process">
            function <span class="apidocSignatureSpan">jscoverage.spec.</span>process
            <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.tap">module jscoverage.tap</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.tap.process">
            function <span class="apidocSignatureSpan">jscoverage.tap.</span>process
            <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jscoverage.util">module jscoverage.util</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.util.colorful">
            function <span class="apidocSignatureSpan">jscoverage.util.</span>colorful
            <span class="apidocSignatureSpan">(str, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.util.formatCoverage">
            function <span class="apidocSignatureSpan">jscoverage.util.</span>formatCoverage
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jscoverage.util.getType">
            function <span class="apidocSignatureSpan">jscoverage.util.</span>getType
            <span class="apidocSignatureSpan">(covlevel, coverage)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage" id="apidoc.module.jscoverage">module jscoverage</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.config" id="apidoc.element.jscoverage.config">
        function <span class="apidocSignatureSpan">jscoverage.</span>config
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">config = function (obj) {
  var inject_functions = patch.getInjectFunctions();
  for (var i in obj) {
    inject_functions[i] = obj[i];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
exports.enableInject = patch.enableInject;
/**
* config the inject function names
* @param  {Object} obj  {get, replace, call, reset}
* @example
*
*  jsc.<span class="apidocCodeKeywordSpan">config</span>({get:&#x27;$get&#x27;, replace:&#x27;$replace&#x27;});
*
*  =====================
*
*  testMod = require(&#x27;testmodule&#x27;);
*  testMod.$get(&#x27;name&#x27;);
*  testMod.$replace(&#x27;name&#x27;, obj);
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.coverageStats" id="apidoc.element.jscoverage.coverageStats">
        function <span class="apidocSignatureSpan">jscoverage.</span>coverageStats
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">coverageStats = function () {
  var file;
  var tmp;
  var lineTotal;
  var lineHits;
  var branchTotal;
  var branchHits;
  var n, len;
  var stats = {};
  var branches, branchesMap, branch;
  var line, start, offset;
  if (typeof _$jscoverage === &#x27;undefined&#x27;) {
    return;
  }
  for (var i in _$jscoverage) {
    file = i;
    tmp = _$jscoverage[i];
    if (!tmp.length) {
      continue;
    }
    // reset the counters;
    lineTotal = lineHits = 0;
    branchTotal = branchHits = 0;

    for (n = 0, len = tmp.length; n &#x3c; len; n++) {
      if (tmp[n] !== undefined) {
        lineTotal ++;
        if (tmp[n] &#x3e; 0) {
          lineHits ++;
        }
      }
    }
    // calculate the branches coverage
    branches = tmp.condition;
    branchesMap = {};
    for (n in branches) {
      if (branches[n] === 0) {
        branch = n.split(&#x27;_&#x27;);
        line = branch[0];
        start = parseInt(branch[1], 10);
        offset = parseInt(branch[2], 10);
        if (!branchesMap[line]) {
          branchesMap[line] = [];
        }
        branchesMap[line].push([start, offset]);
      } else {
        branchHits ++;
      }
      branchTotal ++;
    }
    stats[file] = {
      lineSloc: lineTotal,
      lineHits: lineHits,
      lineCoverage: lineTotal ? fixData(lineHits / lineTotal) : 1,
      branchSloc: branchTotal,
      branchHits: branchHits,
      branchCoverage: branchTotal ? fixData(branchHits / branchTotal) : 1,
      branches: branchesMap
    };
  }
  return stats;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.process(_$jscoverage, exports.<span class="apidocCodeKeywordSpan">coverageStats</span>(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.enableInject" id="apidoc.element.jscoverage.enableInject">
        function <span class="apidocSignatureSpan">jscoverage.</span>enableInject
        <span class="apidocSignatureSpan">(bool)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">enableInject = function (bool) {
  covInject = bool;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    });
  } catch (e) {
    // do nothing
  }
});
if (argv.covinject) {
  debug(&#x27;covinject enabled&#x27;);
  patch.<span class="apidocCodeKeywordSpan">enableInject</span>(true);
}
if (!covIgnore) {
  try {
    var stat = fs.statSync(&#x27;.covignore&#x27;);
    stat &#x26;&#x26; (covIgnore = &#x27;.covignore&#x27;);
    debug(&#x27;.covignore file found!&#x27;);
  } catch (e) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.getLCOV" id="apidoc.element.jscoverage.getLCOV">
        function <span class="apidocSignatureSpan">jscoverage.</span>getLCOV
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getLCOV = function () {
  var tmp;
  var total;
  var touched;
  var n, len;
  var lcov = &#x27;&#x27;;
  if (typeof _$jscoverage === &#x27;undefined&#x27;) {
    return;
  }
  Object.keys(_$jscoverage).forEach(function (file) {
    lcov += &#x27;SF:&#x27; + file + &#x27;\n&#x27;;
    tmp = _$jscoverage[file];
    if (!tmp.length) {
      return;
    }
    total = touched = 0;
    for (n = 0, len = tmp.length; n &#x3c; len; n++) {
      if (tmp[n] !== undefined) {
        lcov += &#x27;DA:&#x27; + n + &#x27;,&#x27; + tmp[n] + &#x27;\n&#x27;;
        total ++;
        if (tmp[n] &#x3e; 0) {
          touched++;
        }
      }
    }
    lcov += &#x27;end_of_record\n&#x27;;
  });
  return lcov;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.instrument" id="apidoc.element.jscoverage.instrument">
        function <span class="apidocSignatureSpan">jscoverage.</span>instrument
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Instrument() {
<span class="apidocCodeCommentSpan">  /**
   * filename needed
   * @type {String}
   */
</span>  this.filename = null;
  /**
   * store injected code
   * @type {String}
   */
  this.code = null;
  /**
   * 储存line信息
   * @type {Array}
   */
  this.lines = [];
  /**
   * 储存condition信息
   * @type {Object}
   */
  this.conds = {};
  /**
   * source code in array
   * @type {Array}
   */
  this.source = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.process" id="apidoc.element.jscoverage.process">
        function <span class="apidocSignatureSpan">jscoverage.</span>process
        <span class="apidocSignatureSpan">(filename, content)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (filename, content) {
  if (!filename) {
    throw new Error(&#x27;jscoverage.process(filename, content), filename needed!&#x27;);
  }
  filename = filename.replace(/\\/g, &#x27;/&#x27;);
  if (!content) {
    return &#x27;&#x27;;
  }
  var pwd = process.cwd();
  var fname;
  if (filename.indexOf(pwd) === 0) {
    fname = filename.substr(pwd.length + 1);
  } else {
    fname = filename;
  }
  var instrObj;
  var ist = new Instrument();
  instrObj = ist.process(fname, content);
  return genCodeCoverage(instrObj);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.processFile" id="apidoc.element.jscoverage.processFile">
        function <span class="apidocSignatureSpan">jscoverage.</span>processFile
        <span class="apidocSignatureSpan">(source, dest, option)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processFile = function (source, dest, option) {
  var content;
  var stats;
  // test source is file or dir, or not a file
  try {
    stats = fs.statSync(source);
    if (stats.isDirectory()) {
      throw new Error(&#x27;path is dir&#x27;);
    } else if (!stats.isFile()) {
      throw new Error(&#x27;path is not a regular file&#x27;);
    }
  } catch (e) {
    throw new Error(&#x27;source file error&#x27; + e);
  }

  fs.sync().mkdir(path.dirname(dest));

  content = fs.readFileSync(source).toString();
  var sheBang = false;
  if (content.charCodeAt(0) === 65279) {
    content = content.substr(1);
  }
  // cut the shebang
  if (content.indexOf(&#x27;#!&#x27;) === 0) {
    var firstLineEnd = content.indexOf(&#x27;\n&#x27;);
    sheBang = content.substr(0, firstLineEnd + 1);
    content = content.substr(firstLineEnd + 1);
  }
  // check if coffee script
  var ext = path.extname(source);
  if (ext === &#x27;.coffee&#x27; || ext === &#x27;.litcoffee&#x27;) {
    var CoffeeScript = require(&#x27;coffee-script&#x27;);
    content = CoffeeScript.compile(content, {
      filename: source
    });
  }
  content = this.process(source, content);
  if (sheBang) {
    content = sheBang + content;
  }
  fs.writeFileSync(dest, content);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.config" id="apidoc.module.jscoverage.config">module jscoverage.config</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.config.config" id="apidoc.element.jscoverage.config.config">
        function <span class="apidocSignatureSpan">jscoverage.</span>config
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">config = function (obj) {
  var inject_functions = patch.getInjectFunctions();
  for (var i in obj) {
    inject_functions[i] = obj[i];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
exports.enableInject = patch.enableInject;
/**
* config the inject function names
* @param  {Object} obj  {get, replace, call, reset}
* @example
*
*  jsc.<span class="apidocCodeKeywordSpan">config</span>({get:&#x27;$get&#x27;, replace:&#x27;$replace&#x27;});
*
*  =====================
*
*  testMod = require(&#x27;testmodule&#x27;);
*  testMod.$get(&#x27;name&#x27;);
*  testMod.$replace(&#x27;name&#x27;, obj);
*/
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.coverageStats" id="apidoc.module.jscoverage.coverageStats">module jscoverage.coverageStats</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.coverageStats.coverageStats" id="apidoc.element.jscoverage.coverageStats.coverageStats">
        function <span class="apidocSignatureSpan">jscoverage.</span>coverageStats
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">coverageStats = function () {
  var file;
  var tmp;
  var lineTotal;
  var lineHits;
  var branchTotal;
  var branchHits;
  var n, len;
  var stats = {};
  var branches, branchesMap, branch;
  var line, start, offset;
  if (typeof _$jscoverage === &#x27;undefined&#x27;) {
    return;
  }
  for (var i in _$jscoverage) {
    file = i;
    tmp = _$jscoverage[i];
    if (!tmp.length) {
      continue;
    }
    // reset the counters;
    lineTotal = lineHits = 0;
    branchTotal = branchHits = 0;

    for (n = 0, len = tmp.length; n &#x3c; len; n++) {
      if (tmp[n] !== undefined) {
        lineTotal ++;
        if (tmp[n] &#x3e; 0) {
          lineHits ++;
        }
      }
    }
    // calculate the branches coverage
    branches = tmp.condition;
    branchesMap = {};
    for (n in branches) {
      if (branches[n] === 0) {
        branch = n.split(&#x27;_&#x27;);
        line = branch[0];
        start = parseInt(branch[1], 10);
        offset = parseInt(branch[2], 10);
        if (!branchesMap[line]) {
          branchesMap[line] = [];
        }
        branchesMap[line].push([start, offset]);
      } else {
        branchHits ++;
      }
      branchTotal ++;
    }
    stats[file] = {
      lineSloc: lineTotal,
      lineHits: lineHits,
      lineCoverage: lineTotal ? fixData(lineHits / lineTotal) : 1,
      branchSloc: branchTotal,
      branchHits: branchHits,
      branchCoverage: branchTotal ? fixData(branchHits / branchTotal) : 1,
      branches: branchesMap
    };
  }
  return stats;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.process(_$jscoverage, exports.<span class="apidocCodeKeywordSpan">coverageStats</span>(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.detail" id="apidoc.module.jscoverage.detail">module jscoverage.detail</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.detail.process" id="apidoc.element.jscoverage.detail.process">
        function <span class="apidocSignatureSpan">jscoverage.detail.</span>process
        <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, debug)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (_$jscoverage, stats, covlevel, debug) {
  var file;
  var tmp;
  var source;
  var lines;
  var allcovered;
  DEBUG = debug === true ? true : false;
  for (var i in _$jscoverage) {
    file = i;
    tmp = _$jscoverage[i];
    if (typeof tmp === &#x27;function&#x27; || tmp.length === undefined) {
      continue;
    }
    source = tmp.source;
    allcovered = true;
    //console.log(&#x27;[JSCOVERAGE]&#x27;,file);

    lines = [];
    for (var n = 0, len = source.length; n &#x3c; len ; n++) {
      if (tmp[n] === 0) {
        lines[n] = 1;
        allcovered = false;
      } else {
        lines[n] = 0;
      }
    }
    if (allcovered) {
      console.log(file, colorful(&#x27;\t100% covered&#x27;, &#x27;GREEN&#x27;));
    } else {
      console.log(&#x27;[UNCOVERED CODE]&#x27;, file);
      printCoverageDetail(lines, source);
    }
    console.log(&#x27;\n\n&#x27;);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.enableInject" id="apidoc.module.jscoverage.enableInject">module jscoverage.enableInject</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.enableInject.enableInject" id="apidoc.element.jscoverage.enableInject.enableInject">
        function <span class="apidocSignatureSpan">jscoverage.</span>enableInject
        <span class="apidocSignatureSpan">(bool)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">enableInject = function (bool) {
  covInject = bool;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    });
  } catch (e) {
    // do nothing
  }
});
if (argv.covinject) {
  debug(&#x27;covinject enabled&#x27;);
  patch.<span class="apidocCodeKeywordSpan">enableInject</span>(true);
}
if (!covIgnore) {
  try {
    var stat = fs.statSync(&#x27;.covignore&#x27;);
    stat &#x26;&#x26; (covIgnore = &#x27;.covignore&#x27;);
    debug(&#x27;.covignore file found!&#x27;);
  } catch (e) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.getLCOV" id="apidoc.module.jscoverage.getLCOV">module jscoverage.getLCOV</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.getLCOV.getLCOV" id="apidoc.element.jscoverage.getLCOV.getLCOV">
        function <span class="apidocSignatureSpan">jscoverage.</span>getLCOV
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getLCOV = function () {
  var tmp;
  var total;
  var touched;
  var n, len;
  var lcov = &#x27;&#x27;;
  if (typeof _$jscoverage === &#x27;undefined&#x27;) {
    return;
  }
  Object.keys(_$jscoverage).forEach(function (file) {
    lcov += &#x27;SF:&#x27; + file + &#x27;\n&#x27;;
    tmp = _$jscoverage[file];
    if (!tmp.length) {
      return;
    }
    total = touched = 0;
    for (n = 0, len = tmp.length; n &#x3c; len; n++) {
      if (tmp[n] !== undefined) {
        lcov += &#x27;DA:&#x27; + n + &#x27;,&#x27; + tmp[n] + &#x27;\n&#x27;;
        total ++;
        if (tmp[n] &#x3e; 0) {
          touched++;
        }
      }
    }
    lcov += &#x27;end_of_record\n&#x27;;
  });
  return lcov;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.html" id="apidoc.module.jscoverage.html">module jscoverage.html</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.html.process" id="apidoc.element.jscoverage.html.process">
        function <span class="apidocSignatureSpan">jscoverage.html.</span>process
        <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (_$jscoverage, stats, covlevel, name, utils) {
  var result = map(_$jscoverage, stats);
  var tplMain = path.join(__dirname, &#x27;/templates/coverage.ejs&#x27;);
  var tplEachFile = path.join(__dirname, &#x27;/templates/eachfile.ejs&#x27;);
  var tplOverview = path.join(__dirname, &#x27;/templates/overview.ejs&#x27;);
  tplMain = fs.readFileSync(tplMain, &#x27;utf8&#x27;).toString();
  tplEachFile = fs.readFileSync(tplEachFile, &#x27;utf8&#x27;).toString();
  tplOverview = fs.readFileSync(tplOverview, &#x27;utf8&#x27;).toString();
  result.instrumentation = name;

  function covClass(n) {
    // n = n;
    if (n &#x3e;= covlevel.high) {
      return &#x27;high&#x27;;
    }
    if (n &#x3e;= covlevel.middle) {
      return &#x27;medium&#x27;;
    }
    if (n &#x3e;= covlevel.low) {
      return &#x27;low&#x27;;
    }
    return &#x27;terrible&#x27;;
  }
  var main = ejs.render(tplMain, {
    debug: false,
    cov: result,
    coverageClass: covClass,
    formatCoverage:utils.formatCoverage,
    filename: path.join(__dirname, &#x27;./templates/cached.ejs&#x27;)
  });
  fs.sync().save(process.cwd() + &#x27;/covreporter/index.html&#x27;, main);

  var overview = ejs.render(tplOverview, {
    debug: false,
    cov: result,
    coverageClass: covClass,
    formatCoverage:utils.formatCoverage,
    filename: path.join(__dirname, &#x27;./templates/cached.ejs&#x27;)
  });
  fs.sync().save(process.cwd() + &#x27;/covreporter/overview.js&#x27;,
    &#x27;displayFile(&#x27; + JSON.stringify(overview) + &#x27;);&#x27;);

  result.files.forEach(function (file) {
    var ff = ejs.render(tplEachFile, {
      debug: false,
      file: file,
      coverageClass: covClass,
      formatCoverage:utils.formatCoverage,
      cov: covClass
    });
    fs.sync().save(process.cwd() + &#x27;/covreporter/&#x27; + file.filename,
      &#x27;displayFile(&#x27; + JSON.stringify(ff) + &#x27;);&#x27;);
  });

  console.log(&#x27;[REPORTER]: &#x27;, process.cwd() + &#x27;/covreporter&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.instrument" id="apidoc.module.jscoverage.instrument">module jscoverage.instrument</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.instrument.instrument" id="apidoc.element.jscoverage.instrument.instrument">
        function <span class="apidocSignatureSpan">jscoverage.</span>instrument
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Instrument() {
<span class="apidocCodeCommentSpan">  /**
   * filename needed
   * @type {String}
   */
</span>  this.filename = null;
  /**
   * store injected code
   * @type {String}
   */
  this.code = null;
  /**
   * 储存line信息
   * @type {Array}
   */
  this.lines = [];
  /**
   * 储存condition信息
   * @type {Object}
   */
  this.conds = {};
  /**
   * source code in array
   * @type {Array}
   */
  this.source = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.instrument.prototype" id="apidoc.module.jscoverage.instrument.prototype">module jscoverage.instrument.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.instrument.prototype.checkIfIgnore" id="apidoc.element.jscoverage.instrument.prototype.checkIfIgnore">
        function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>checkIfIgnore
        <span class="apidocSignatureSpan">(node, stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkIfIgnore = function (node, stack) {
  var cmt;
  if (node.start &#x26;&#x26; node.start.comments_before.length) {
    cmt = node.start.comments_before[node.start.comments_before.length - 1];
    if (/@covignore/.test(cmt.value) &#x26;&#x26; !(node instanceof Uglify.AST_Toplevel)) {
      node.__covignore = true;
    }
  }
  if (node.__covignore) {
    return true;
  }
  if (stack) {
    for (var i = stack.length - 1; i &#x3e; 0; i--) {
      if (stack[i].__covignore) {
        return true;
      }
    }
  }
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var ast = Uglify.parse(code);

this.filename = filename;
this.source = code.split(/\r?\n/);

// init walker
var walker = new Uglify.TreeWalker(function (node) {
  if (ist.<span class="apidocCodeKeywordSpan">checkIfIgnore</span>(node, walker.stack)) {
    return;
  }
  var parent = this.parent();
  if (node instanceof Uglify.AST_Conditional) { // 三元判断
    debug(&#x27;node type:&#x27;, node.TYPE, &#x27;parent type:&#x27;, parent &#x26;&#x26; parent.TYPE);
    node.consequent = ist.inject(&#x27;cond&#x27;, node.consequent.start.line, node.consequent);
    node.alternative = ist.inject(&#x27;cond&#x27;, node.alternative.start.line, node.alternative);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.instrument.prototype.ifExclude" id="apidoc.element.jscoverage.instrument.prototype.ifExclude">
        function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>ifExclude
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ifExclude = function (node) {
  if (node instanceof Uglify.AST_LoopControl) {
    return false;
  }
  if (
    node instanceof Uglify.AST_IterationStatement ||
    node instanceof Uglify.AST_StatementWithBody ||
    node instanceof Uglify.AST_Block
  ) {
    return true;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        for (var i = 0; i &#x3c; len; i++) {
subNode = node.body[i];
if (ist.checkIfIgnore(subNode, walker.stack)) {
  res.push(subNode);
  continue;
}
if (subNode instanceof Uglify.AST_Statement) {
  if (ist.<span class="apidocCodeKeywordSpan">ifExclude</span>(subNode)) {
    res.push(subNode);
    continue;
  }
  res.push(ist.inject(&#x27;line&#x27;, subNode.start.line));
} else if (subNode instanceof Uglify.AST_Var) {
  res.push(ist.inject(&#x27;line&#x27;, subNode.start.line));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.instrument.prototype.inject" id="apidoc.element.jscoverage.instrument.prototype.inject">
        function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>inject
        <span class="apidocSignatureSpan">(type, line, expr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inject = function (type, line, expr) {
  var args = [];
  if (type === this.T_LINE) {
    this.lines.push(line);
    args = [
      new Uglify.AST_String({value: this.filename}),
      new Uglify.AST_String({value: type}),
      new Uglify.AST_Number({value: line})
    ];
  } else if (type === this.T_COND) {
    var start = expr.start.col;
    var offset = expr.end.endpos - expr.start.pos;
    var key = line + &#x27;_&#x27; + start + &#x27;_&#x27; + offset;  // 编码
    this.conds[key] = 0;
    args = [
      new Uglify.AST_String({value: this.filename}),
      new Uglify.AST_String({value: type}),
      new Uglify.AST_String({value: key}),
      expr
    ];
  }

  var call = new Uglify.AST_Call({
    expression: new Uglify.AST_SymbolRef({name: &#x27;_$jscmd&#x27;}),
    //end: new Uglify.AST_
    args: args
  });

  if (type === this.T_LINE) {
    return new Uglify.AST_SimpleStatement({
      body: call,
      end: new Uglify.AST_Token({value: &#x27;;&#x27;})
    });
  } else {
    return call;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var walker = new Uglify.TreeWalker(function (node) {
if (ist.checkIfIgnore(node, walker.stack)) {
  return;
}
var parent = this.parent();
if (node instanceof Uglify.AST_Conditional) { // 三元判断
  debug(&#x27;node type:&#x27;, node.TYPE, &#x27;parent type:&#x27;, parent &#x26;&#x26; parent.TYPE);
  node.consequent = ist.<span class="apidocCodeKeywordSpan">inject</span>(&#x27;cond&#x27;, node.consequent.start.line, node.consequent
);
  node.alternative = ist.inject(&#x27;cond&#x27;, node.alternative.start.line, node.alternative);
} else if (node.TYPE === &#x27;Binary&#x27;) {
  debug(&#x27;node type:&#x27;, node.TYPE, &#x27;parent type:&#x27;, parent &#x26;&#x26; parent.TYPE);
  if (node.operator &#x26;&#x26; [&#x27;||&#x27;, &#x27;&#x26;&#x26;&#x27;].indexOf(node.operator) === -1) {
    return;
  }
  if (!(node.left instanceof Uglify.AST_Constant)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.instrument.prototype.process" id="apidoc.element.jscoverage.instrument.prototype.process">
        function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>process
        <span class="apidocSignatureSpan">(filename, code)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (filename, code) {
  if (!filename) {
    throw new Error(&#x27;[jscoverage]instrument need filename!&#x27;);
  }

  //code = this.protectEmptyBlock(code);
  var ist = this;
  // parse ast
  var ast = Uglify.parse(code);

  this.filename = filename;
  this.source = code.split(/\r?\n/);

  // init walker
  var walker = new Uglify.TreeWalker(function (node) {
    if (ist.checkIfIgnore(node, walker.stack)) {
      return;
    }
    var parent = this.parent();
    if (node instanceof Uglify.AST_Conditional) { // 三元判断
      debug(&#x27;node type:&#x27;, node.TYPE, &#x27;parent type:&#x27;, parent &#x26;&#x26; parent.TYPE);
      node.consequent = ist.inject(&#x27;cond&#x27;, node.consequent.start.line, node.consequent);
      node.alternative = ist.inject(&#x27;cond&#x27;, node.alternative.start.line, node.alternative);
    } else if (node.TYPE === &#x27;Binary&#x27;) {
      debug(&#x27;node type:&#x27;, node.TYPE, &#x27;parent type:&#x27;, parent &#x26;&#x26; parent.TYPE);
      if (node.operator &#x26;&#x26; [&#x27;||&#x27;, &#x27;&#x26;&#x26;&#x27;].indexOf(node.operator) === -1) {
        return;
      }
      if (!(node.left instanceof Uglify.AST_Constant)) {
        node.left = ist.inject(&#x27;cond&#x27;, node.left.start.line, node.left);
      }
      if (!(node.right instanceof Uglify.AST_Constant)) {
        node.right = ist.inject(&#x27;cond&#x27;, node.right.start.line, node.right);
      }
    }

    else if (node instanceof Uglify.AST_If) {
      debug(&#x27;node type:&#x27;, node.TYPE, &#x27;parent type:&#x27;, parent &#x26;&#x26; parent.TYPE);
      node.condition = ist.inject(&#x27;cond&#x27;, node.condition.start.line, node.condition);
    }

    var len = node.body ? node.body.length : 0;
    if (len) {
      var res = [];
      var subNode;
      for (var i = 0; i &#x3c; len; i++) {
        subNode = node.body[i];
        if (ist.checkIfIgnore(subNode, walker.stack)) {
          res.push(subNode);
          continue;
        }
        if (subNode instanceof Uglify.AST_Statement) {
          if (ist.ifExclude(subNode)) {
            res.push(subNode);
            continue;
          }
          res.push(ist.inject(&#x27;line&#x27;, subNode.start.line));
        } else if (subNode instanceof Uglify.AST_Var) {
          res.push(ist.inject(&#x27;line&#x27;, subNode.start.line));
        }
        res.push(subNode);
      }
      node.body = res;
    }
  });
  // figure_out_scope
  ast.figure_out_scope();
  // walk process
  ast.walk(walker);

  var out = Uglify.OutputStream({
    preserve_line : true,
    comments: &#x27;all&#x27;,
    beautify: true
  });
  // rebuild file
  ast.print(out);
  this.code = out.toString();
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.instrument.prototype.protectEmptyBlock" id="apidoc.element.jscoverage.instrument.prototype.protectEmptyBlock">
        function <span class="apidocSignatureSpan">jscoverage.instrument.prototype.</span>protectEmptyBlock
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">protectEmptyBlock = function (node) {

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * @return {String} injected code
   */
  process: function (filename, code) {
if (!filename) {
  throw new Error(&#x27;[jscoverage]instrument need filename!&#x27;);
}

//code = this.<span class="apidocCodeKeywordSpan">protectEmptyBlock</span>(code);
var ist = this;
// parse ast
var ast = Uglify.parse(code);

this.filename = filename;
this.source = code.split(/\r?\n/);
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.jscoverage" id="apidoc.module.jscoverage.jscoverage">module jscoverage.jscoverage</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.jscoverage.process" id="apidoc.element.jscoverage.jscoverage.process">
        function <span class="apidocSignatureSpan">jscoverage.jscoverage.</span>process
        <span class="apidocSignatureSpan">(filename, content)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (filename, content) {
  if (!filename) {
    throw new Error(&#x27;jscoverage.process(filename, content), filename needed!&#x27;);
  }
  filename = filename.replace(/\\/g, &#x27;/&#x27;);
  if (!content) {
    return &#x27;&#x27;;
  }
  var pwd = process.cwd();
  var fname;
  if (filename.indexOf(pwd) === 0) {
    fname = filename.substr(pwd.length + 1);
  } else {
    fname = filename;
  }
  var instrObj;
  var ist = new Instrument();
  instrObj = ist.process(fname, content);
  return genCodeCoverage(instrObj);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.list" id="apidoc.module.jscoverage.list">module jscoverage.list</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.list.process" id="apidoc.element.jscoverage.list.process">
        function <span class="apidocSignatureSpan">jscoverage.list.</span>process
        <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (_$jscoverage, stats, covlevel, name, utils) {
  var arr = [];
  var files = Object.keys(stats);
  var colorful = utils.colorful;
  var maxFileName = maxStr(files);
  files.forEach(function (file) {
    var coverage = stats[file].lineCoverage;
    var type;
    if (coverage &#x3e;= covlevel.high) {
      type = &#x27;GREEN&#x27;;
    } else if (coverage &#x3e;= covlevel.middle) {
      type = null;
    } else if (coverage &#x3e;= covlevel.low) {
      type = &#x27;YELLOW&#x27;;
    } else {
      type = &#x27;RED&#x27;;
    }
    var msg =
      &#x27;Coverage &#x27; + fillStr(file, maxFileName) +
        &#x27; line[&#x27; + colorful(formatPercent(stats[file].lineCoverage), type) + &#x27;] &#x27; +
        &#x27; branch[&#x27; + colorful(formatPercent(stats[file].branchCoverage), type) + &#x27;]&#x27;;
    msg = &#x27;  &#x27; + colorful(&#x27;\u204D&#x27;, type) + &#x27; &#x27; +  colorful(msg, &#x27;DEFAULT&#x27;);
    arr.push(msg);
  });
  console.log(&#x27;\n&#x27;);
  console.log(arr.join(&#x27;\n&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.patch" id="apidoc.module.jscoverage.patch">module jscoverage.patch</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.patch.enableInject" id="apidoc.element.jscoverage.patch.enableInject">
        function <span class="apidocSignatureSpan">jscoverage.patch.</span>enableInject
        <span class="apidocSignatureSpan">(bool)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">enableInject = function (bool) {
  covInject = bool;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    });
  } catch (e) {
    // do nothing
  }
});
if (argv.covinject) {
  debug(&#x27;covinject enabled&#x27;);
  patch.<span class="apidocCodeKeywordSpan">enableInject</span>(true);
}
if (!covIgnore) {
  try {
    var stat = fs.statSync(&#x27;.covignore&#x27;);
    stat &#x26;&#x26; (covIgnore = &#x27;.covignore&#x27;);
    debug(&#x27;.covignore file found!&#x27;);
  } catch (e) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.patch.getInjectFunctions" id="apidoc.element.jscoverage.patch.getInjectFunctions">
        function <span class="apidocSignatureSpan">jscoverage.patch.</span>getInjectFunctions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getInjectFunctions = function () {
  return injectFunctions;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*  =====================
*
*  testMod = require(&#x27;testmodule&#x27;);
*  testMod.$get(&#x27;name&#x27;);
*  testMod.$replace(&#x27;name&#x27;, obj);
*/
exports.config = function (obj) {
 var inject_functions = patch.<span class="apidocCodeKeywordSpan">getInjectFunctions</span>();
 for (var i in obj) {
   inject_functions[i] = obj[i];
 }
};
/**
* process Code, inject the coverage code to the input Code string
* @param {String} filename  jscoverage file flag
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.patch.setCovIgnore" id="apidoc.element.jscoverage.patch.setCovIgnore">
        function <span class="apidocSignatureSpan">jscoverage.patch.</span>setCovIgnore
        <span class="apidocSignatureSpan">(ignore, bool)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setCovIgnore = function (ignore, bool) {
  if (bool) {
    covIgnore = ignore;
  } else {
    covIgnore = ignore.concat(defaultCovIgnore);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   }
   if (v.indexOf(&#x27;/&#x27;) === 0) {
     v = &#x27;^&#x27; + cwd + v;
   }
   _ignore.push(new RegExp(v.replace(/\./g, &#x27;\\.&#x27;).replace(/\*/g, &#x27;.*&#x27;)));
 });

 patch.<span class="apidocCodeKeywordSpan">setCovIgnore</span>(_ignore, argv.overrideIgnore ? true : false);
}

var jscoverage = require(&#x27;./lib/jscoverage&#x27;);

/**
* enableInject description
* @param {Boolean} true or false
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.process" id="apidoc.module.jscoverage.process">module jscoverage.process</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.process.process" id="apidoc.element.jscoverage.process.process">
        function <span class="apidocSignatureSpan">jscoverage.</span>process
        <span class="apidocSignatureSpan">(filename, content)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (filename, content) {
  if (!filename) {
    throw new Error(&#x27;jscoverage.process(filename, content), filename needed!&#x27;);
  }
  filename = filename.replace(/\\/g, &#x27;/&#x27;);
  if (!content) {
    return &#x27;&#x27;;
  }
  var pwd = process.cwd();
  var fname;
  if (filename.indexOf(pwd) === 0) {
    fname = filename.substr(pwd.length + 1);
  } else {
    fname = filename;
  }
  var instrObj;
  var ist = new Instrument();
  instrObj = ist.process(fname, content);
  return genCodeCoverage(instrObj);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.processFile" id="apidoc.module.jscoverage.processFile">module jscoverage.processFile</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.processFile.processFile" id="apidoc.element.jscoverage.processFile.processFile">
        function <span class="apidocSignatureSpan">jscoverage.</span>processFile
        <span class="apidocSignatureSpan">(source, dest, option)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processFile = function (source, dest, option) {
  var content;
  var stats;
  // test source is file or dir, or not a file
  try {
    stats = fs.statSync(source);
    if (stats.isDirectory()) {
      throw new Error(&#x27;path is dir&#x27;);
    } else if (!stats.isFile()) {
      throw new Error(&#x27;path is not a regular file&#x27;);
    }
  } catch (e) {
    throw new Error(&#x27;source file error&#x27; + e);
  }

  fs.sync().mkdir(path.dirname(dest));

  content = fs.readFileSync(source).toString();
  var sheBang = false;
  if (content.charCodeAt(0) === 65279) {
    content = content.substr(1);
  }
  // cut the shebang
  if (content.indexOf(&#x27;#!&#x27;) === 0) {
    var firstLineEnd = content.indexOf(&#x27;\n&#x27;);
    sheBang = content.substr(0, firstLineEnd + 1);
    content = content.substr(firstLineEnd + 1);
  }
  // check if coffee script
  var ext = path.extname(source);
  if (ext === &#x27;.coffee&#x27; || ext === &#x27;.litcoffee&#x27;) {
    var CoffeeScript = require(&#x27;coffee-script&#x27;);
    content = CoffeeScript.compile(content, {
      filename: source
    });
  }
  content = this.process(source, content);
  if (sheBang) {
    content = sheBang + content;
  }
  fs.writeFileSync(dest, content);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.spec" id="apidoc.module.jscoverage.spec">module jscoverage.spec</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.spec.process" id="apidoc.element.jscoverage.spec.process">
        function <span class="apidocSignatureSpan">jscoverage.spec.</span>process
        <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (_$jscoverage, stats, covlevel, name, utils) {
  var arr = [];
  var colorful = utils.colorful;
  console.log(&#x27;\n&#x27;);
  console.log(colorful(&#x27;%s%s&#x27;, &#x27;DEFAULT&#x27;), indent(), &#x27;Coverage result&#x27;);
  indents ++;
  var files = Object.keys(stats);
  var maxFileLength = maxStr(files);
  files.forEach(function (file) {
    var coverage = stats[file].lineCoverage;
    var type = utils.getType(covlevel, coverage);
    var head = type[1];
    type = type[0];
    var msg = fillStr(file, maxFileLength) +
      &#x27;line[&#x27; + colorful(formatPercent(stats[file].lineCoverage), type) + &#x27;]&#x27; +
      &#x27;  branch[&#x27; + colorful(formatPercent(stats[file].branchCoverage), type) + &#x27;]&#x27;;
    msg = indent() + colorful(head, type) + &#x27; &#x27; + colorful(msg, &#x27;DEFAULT&#x27;);
    arr.push(msg);
  });
  console.log(arr.join(&#x27;\n&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.tap" id="apidoc.module.jscoverage.tap">module jscoverage.tap</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.tap.process" id="apidoc.element.jscoverage.tap.process">
        function <span class="apidocSignatureSpan">jscoverage.tap.</span>process
        <span class="apidocSignatureSpan">(_$jscoverage, stats, covlevel, name, utils)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (_$jscoverage, stats, covlevel, name, utils) {
  var arr = [];
  var lineSloc = 0, branchSloc = 0;
  var lineHits =0, branchHits = 0;
  var formatCoverage = utils.formatCoverage;
  Object.keys(stats).forEach(function (file) {
    var coverage = stats[file].lineCoverage;
    var type = utils.getType(covlevel, coverage)[0];
    var msg = &#x27;Coverage &#x27; + file + &#x27;: line[&#x27; + utils.colorful(formatCoverage(stats[file].lineCoverage), type) + &#x27;]&#x27; +
      &#x27;, branch[&#x27; + utils.colorful(formatCoverage(stats[file].branchCoverage), type) + &#x27;]&#x27;;
    msg = &#x27;#  &#x27; + utils.colorful(&#x27;\u204D&#x27;, type) + &#x27; &#x27; +  utils.colorful(msg, &#x27;DEFAULT&#x27;);
    arr.push(msg);
    lineSloc += stats[file].lineSloc;
    lineHits += stats[file].lineHits;
    branchSloc += stats[file].branchSloc;
    branchHits += stats[file].branchHits;
  });
  console.log(&#x27;\n&#x27;);
  console.log(arr.join(&#x27;\n&#x27;));
  var lineCoverage = formatCoverage(lineHits / lineSloc);
  var branchCoverage = formatCoverage(branchHits / branchSloc);

  console.log(&#x27;# coverage line %s, branch %s&#x27;, lineCoverage, branchCoverage);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var reporter;
      if (/^\w+$/.test(argv.covout)) {
        reporter = require(&#x27;./reporter/&#x27; + argv.covout);
      } else {
        reporter = require(argv.covout);
      }
      reporter.<span class="apidocCodeKeywordSpan">process</span>(_$jscoverage, exports.coverageStats(), covlevel, COV_REPORT_NAME
, rptUtil);
    } catch (e) {
      console.error(&#x27;jscoverage reporter error&#x27;, e, e.stack);
    }
  });
} catch (e) {
  // do nothing
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jscoverage.util" id="apidoc.module.jscoverage.util">module jscoverage.util</a></h1>


    <h2>
        <a href="#apidoc.element.jscoverage.util.colorful" id="apidoc.element.jscoverage.util.colorful">
        function <span class="apidocSignatureSpan">jscoverage.util.</span>colorful
        <span class="apidocSignatureSpan">(str, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">colorful = function (str, type) {
  if (!type) {
    return str;
  }
  var head = &#x27;\x1B[&#x27;, foot = &#x27;\x1B[0m&#x27;;
  var color = {
    LINENUM : 36,
    GREEN  : 32,
    YELLOW  : 33,
    RED : 31,
    DEFAULT: 0
  };
  return head + color[type] + &#x27;m&#x27; + str + foot;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var arr = [];
var lineSloc = 0, branchSloc = 0;
var lineHits =0, branchHits = 0;
var formatCoverage = utils.formatCoverage;
Object.keys(stats).forEach(function (file) {
  var coverage = stats[file].lineCoverage;
  var type = utils.getType(covlevel, coverage)[0];
  var msg = &#x27;Coverage &#x27; + file + &#x27;: line[&#x27; + utils.<span class="apidocCodeKeywordSpan">colorful</span>(formatCoverage
(stats[file].lineCoverage), type) + &#x27;]&#x27; +
    &#x27;, branch[&#x27; + utils.colorful(formatCoverage(stats[file].branchCoverage), type) + &#x27;]&#x27;;
  msg = &#x27;#  &#x27; + utils.colorful(&#x27;\u204D&#x27;, type) + &#x27; &#x27; +  utils.colorful(msg, &#x27;DEFAULT&#x27;);
  arr.push(msg);
  lineSloc += stats[file].lineSloc;
  lineHits += stats[file].lineHits;
  branchSloc += stats[file].branchSloc;
  branchHits += stats[file].branchHits;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.util.formatCoverage" id="apidoc.element.jscoverage.util.formatCoverage">
        function <span class="apidocSignatureSpan">jscoverage.util.</span>formatCoverage
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">formatCoverage = function (n) {
  var str = Math.floor(n * 10000)/100 + &#x27;%&#x27;;
  return str;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jscoverage.util.getType" id="apidoc.element.jscoverage.util.getType">
        function <span class="apidocSignatureSpan">jscoverage.util.</span>getType
        <span class="apidocSignatureSpan">(covlevel, coverage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getType = function (covlevel, coverage) {
  var type;
  var head;
  if (coverage &#x3e;= covlevel.high) {
      type = &#x27;GREEN&#x27;;
      head = symbols.ok;
    } else if (coverage &#x3e;= covlevel.middle) {
      type = null;
      head = symbols.ok;
    } else if (coverage &#x3e;= covlevel.low) {
      type = &#x27;YELLOW&#x27;;
      head = symbols.warn;
    } else {
      type = &#x27;RED&#x27;;
      head = symbols.err;
    }
  return [type, head];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.log(&#x27;\n&#x27;);
console.log(colorful(&#x27;%s%s&#x27;, &#x27;DEFAULT&#x27;), indent(), &#x27;Coverage result&#x27;);
indents ++;
var files = Object.keys(stats);
var maxFileLength = maxStr(files);
files.forEach(function (file) {
  var coverage = stats[file].lineCoverage;
  var type = utils.<span class="apidocCodeKeywordSpan">getType</span>(covlevel, coverage);
  var head = type[1];
  type = type[0];
  var msg = fillStr(file, maxFileLength) +
    &#x27;line[&#x27; + colorful(formatPercent(stats[file].lineCoverage), type) + &#x27;]&#x27; +
    &#x27;  branch[&#x27; + colorful(formatPercent(stats[file].branchCoverage), type) + &#x27;]&#x27;;
  msg = indent() + colorful(head, type) + &#x27; &#x27; + colorful(msg, &#x27;DEFAULT&#x27;);
  arr.push(msg);
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
